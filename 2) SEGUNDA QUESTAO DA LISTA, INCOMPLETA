#include <stdio.h>
#include <string.h>
#include <stdlib.h>

typedef struct Result {
    char games[100];
    char event[200];
    char team[100];
    char pos[50];
    char medal[20];
    char as[100];
    int athlete_id;
    char noc[10];
    char discipline[100];
} Result;

int main() {
    char line[4096];
    char paisEscolhido[10];
    Result res;
    int womenCount = 0;
    int menCount = 0;
    float mediaMedalhas = 0;

    FILE *file = fopen("results.csv", "r");
    if (file == NULL) {
        printf("Erro ao abrir o arquivo.\n");
        return 1;
    }

    printf("Digite um sigla NOC do paÃ­s (ex: USA, BRA, FRA): ");
    scanf("%s", paisEscolhido);

    fgets(line, sizeof(line), file); 

    while (fgets(line, sizeof(line), file)) {
        strcpy(res.medal, "");

        sscanf(line, "%[^,],%*[^,],%*[^,],\"%[^\"]\",%*[^,],%*[^,],%[^,],%*[^,],%*[^,],%*[^,],%s",
               res.games, res.event, res.noc, res.medal);

        int ano = (int)atof(res.games);
        
        if (ano >= 2008) {
            if (strlen(res.medal) > 0 && strcmp(res.medal, "NA") != 0) {
                if (strcmp(res.noc, paisEscolhido) == 0) {
                    if (strstr(res.event, "Feminino") != NULL) {
                        womenCount++;
                    } 
                    else if (strstr(res.event, "Masculino") != NULL) {
                        menCount++;
                    }
                }
            }
        }
    }

    if (menCountBra > 0) {
        mediaMedalhas = (float)womenCount / menCount;
    }

    printf("Homens originados de %s medalhistas: %d Mulheres originadas de %s medalhistas: %d\n media: %.2f", 
           paisEscolhido, menCount, paisEscolhido, womenCount, mediaMedalhas);

    fclose(file);
    return 0;
}
